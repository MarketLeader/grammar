(function(t){function i(t,i){t.prototype=Object.create(i.prototype),t.prototype.$super=i.prototype}function d(){return[].slice.call(arguments).reduce(function(t,i){return void 0!==t?t:i})}function u(t,i){var e=t-i;switch(m.INTERNAL_ALIGNMENT){case"left":return[0,e];case"right":return[e,0];case"center":default:return[e/2,e/2]}}function r(t){return"string"==typeof t?new w(t):t}function e(t){for(var i=0;i<t.length;i++)if(t[i]instanceof s&&i!==t.length-1)return!0;return!1}function c(t,i,e){return this instanceof c?(this.children=e||[],this.tagName=t,this.attrs=d(i,{}),this):new c(t,i,e)}function f(t,i){if(!(this instanceof f))return new f(t,i);c.call(this,"path"),this.attrs.d="M"+t+" "+i}function m(t){if(!(this instanceof m))return new m([].slice.call(arguments));if(c.call(this,"svg",{class:m.DIAGRAM_CLASS}),e(t))throw new RangeError("Stack() must only occur at the very last position of Diagram().");this.items=t.map(r),this.items.unshift(new l),this.items.push(new g),this.width=this.items.reduce(function(t,i){return t+i.width+(i.needsSpace?20:0)},0)+1,this.height=this.items.reduce(function(t,i){return t+i.height},0),this.up=Math.max.apply(null,this.items.map(function(t){return t.up})),this.down=Math.max.apply(null,this.items.map(function(t){return t.down})),this.formatted=!1}for(var n in c.prototype.format=function(t,i,e){},c.prototype.addTo=function(t){if(t instanceof c)return t.children.push(this),this;var i=this.toSVG();return t.appendChild(i),i},c.prototype.escapeString=function(t){return t.replace(/[*_\`\[\]<&]/g,function(t){return"&#"+t.charCodeAt(0)+";"})},c.prototype.toSVG=function(){var i=function(t,i,e){i=i||{},e=e||"";var n=document.createElementNS("http://www.w3.org/2000/svg",t);for(var r in i)"xlink:href"===r?n.setAttributeNS("http://www.w3.org/1999/xlink","href",i[r]):n.setAttribute(r,i[r]);return n.textContent=e,n}(this.tagName,this.attrs);return"string"==typeof this.children?i.textContent=this.children:this.children.forEach(function(t){i.appendChild(t.toSVG())}),i},c.prototype.toString=function(){var i="<"+this.tagName,t="g"==this.tagName||"svg"==this.tagName;for(var e in this.attrs)i+=" "+e+'="'+(this.attrs[e]+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")+'"';return i+=">",t&&(i+="\n"),"string"==typeof this.children?i+=c.prototype.escapeString(this.children):this.children.forEach(function(t){i+=t}),i+="</"+this.tagName+">\n"},i(f,c),f.prototype.m=function(t,i){return this.attrs.d+="m"+t+" "+i,this},f.prototype.right=f.prototype.h=function(t){return this.attrs.d+="h"+t,this},f.prototype.left=function(t){return this.h(-t)},f.prototype.down=f.prototype.v=function(t){return this.attrs.d+="v"+t,this},f.prototype.up=function(t){return this.v(-t)},f.prototype.arc=function(t){var i=m.ARC_RADIUS,e=m.ARC_RADIUS;if("e"!=t[0]&&"w"!=t[1]||(i*=-1),"s"!=t[0]&&"n"!=t[1]||(e*=-1),"ne"==t||"es"==t||"sw"==t||"wn"==t)var n=1;else n=0;return this.attrs.d+="a"+m.ARC_RADIUS+" "+m.ARC_RADIUS+" 0 0 "+n+" "+i+" "+e,this},f.prototype.format=function(){return this.attrs.d+="h.5",this},i(m,c),t)m[n]=t[n];function h(t){if(!(this instanceof h))return new h([].slice.call(arguments));if(c.call(this,"g"),e(t))throw new RangeError("Stack() must only occur at the very last position of Sequence().");this.items=t.map(r),this.width=this.items.reduce(function(t,i){return t+i.width+(i.needsSpace?20:0)},0),this.offsetX=0,this.height=this.items.reduce(function(t,i){return t+i.height},0),this.up=this.items.reduce(function(t,i){return Math.max(t,i.up)},0),this.down=this.items.reduce(function(t,i){return Math.max(t,i.down)},0)}function s(t){if(!(this instanceof s))return new s([].slice.call(arguments));if(c.call(this,"g"),e(t))throw new RangeError("Stack() must only occur at the very last position of Stack().");if(0===t.length)throw new RangeError("Stack() must have at least one child.");this.items=t.map(r),this.width=this.items.reduce(function(t,i){return Math.max(t,i.width+(i.needsSpace?20:0))},0),1<this.items.length&&(this.width+=2*m.ARC_RADIUS),this.up=this.items[0].up,this.down=this.items[this.items.length-1].down;for(var i=this.height=0;i<this.items.length;i++)this.height+=this.items[i].height,i!==this.items.length-1&&(this.height+=Math.max(this.items[i].down,m.VERTICAL_SEPARATION)+Math.max(this.items[i+1].up,m.VERTICAL_SEPARATION)+4*m.ARC_RADIUS);0===this.items.length?this.offsetX=0:(this.offsetX=-(this.width-this.items[this.items.length-1].width-this.items[this.items.length-1].offsetX-(this.items[this.items.length-1].needsSpace?20:0)),1<this.items.length&&(this.offsetX+=2*m.ARC_RADIUS))}function a(t,i){if(!(this instanceof a))return new a(t,[].slice.call(arguments,1));if(c.call(this,"g"),"number"!=typeof t||t!==Math.floor(t))throw new TypeError("The first argument of Choice() must be an integer.");if(t<0||t>=i.length)throw new RangeError("The first argument of Choice() must be an index for one of the items.");this.normal=t,this.items=i.map(r),this.width=this.items.reduce(function(t,i){return Math.max(t,i.width)},0)+4*m.ARC_RADIUS,this.offsetX=0,this.height=this.items[t].height,this.up=this.down=0;for(var e=0;e<this.items.length;e++){var n=this.items[e];e<t&&(this.up+=Math.max(m.ARC_RADIUS,n.up+n.height+n.down+m.VERTICAL_SEPARATION)),e==t&&(this.up+=Math.max(m.ARC_RADIUS,n.up),this.down+=Math.max(m.ARC_RADIUS,n.down)),t<e&&(this.down+=Math.max(m.ARC_RADIUS,m.VERTICAL_SEPARATION+n.up+n.down+n.height))}}function o(t,i){if(void 0===i)return a(1,S(),t);if("skip"===i)return a(0,S(),t);throw"Unknown value for Optional()'s 'skip' argument."}function p(t,i){if(!(this instanceof p))return new p(t,i);c.call(this,"g"),i=i||new S,this.item=r(t),this.rep=r(i),this.width=Math.max(this.item.width,this.rep.width)+2*m.ARC_RADIUS,this.offsetX=0,this.height=this.item.height,this.up=this.item.up,this.down=Math.max(2*m.ARC_RADIUS,this.item.down+m.VERTICAL_SEPARATION+this.rep.up+this.rep.height+this.rep.down)}function l(t){if(!(this instanceof l))return new l;c.call(this,"path"),this.width=20,this.height=0,this.offsetX=0,this.up=10,this.down=10,this.simpleType=t}function g(t){if(!(this instanceof g))return new g;c.call(this,"path"),this.width=20,this.height=0,this.offsetX=0,this.up=10,this.down=10,this.simpleType=t}function w(t,i,e,n,r,h,s){if(!(this instanceof w))return new w(t,i,e,n,r,h,s);c.call(this,"g",{class:"terminal"}),this.text=t,this.label=t,this.href=i,this.title=e,this.occurrenceIdx=n,this.topRuleName=r,this.dslRuleName=h,this.tokenName=s,this.width=8*t.length+20,this.height=0,this.offsetX=0,this.up=11,this.down=11}function A(t,i,e,n){if(!(this instanceof A))return new A(t,i,e,n);c.call(this,"g",{class:"non-terminal"}),this.text=t,this.ruleName=t,this.href=i,this.occurrenceIdx=e,this.topRuleName=n,this.width=8*t.length+20,this.height=0,this.offsetX=0,this.up=11,this.down=11}function R(t){if(!(this instanceof R))return new R(t);c.call(this,"g"),this.text=t,this.width=7*t.length+10,this.height=0,this.offsetX=0,this.up=11,this.down=11}function S(){if(!(this instanceof S))return new S;c.call(this,"g"),this.width=0,this.height=0,this.offsetX=0,this.up=0,this.down=0}var T;m.prototype.format=function(t,i,e,n){i=d(i,t=d(t,20),20),e=d(e,t,20);var r=n=d(n,i,20),h=t;h+=this.up;for(var s=c("g",m.STROKE_ODD_PIXEL_LENGTH?{transform:"translate(.5 .5)"}:{}),a=0;a<this.items.length;a++){var o=this.items[a];o.needsSpace&&(f(r,h).h(10).addTo(s),r+=10),o.format(r,h,o.width+o.offsetX).addTo(s),r+=o.width+o.offsetX,h+=o.height,o.needsSpace&&(f(r,h).h(10).addTo(s),r+=10)}return this.attrs.width=this.width+n+i,this.attrs.height=this.up+this.height+this.down+t+e,this.attrs.viewBox="0 0 "+this.attrs.width+" "+this.attrs.height,s.addTo(this),this.formatted=!0,this},m.prototype.addTo=function(t){var i=document.getElementsByTagName("script"),e=(i=i[i.length-1]).parentNode;return t=t||e,this.$super.addTo.call(this,t)},m.prototype.toSVG=function(){return this.formatted||this.format(),this.$super.toSVG.call(this)},m.prototype.toString=function(){return this.formatted||this.format(),this.$super.toString.call(this)},i(h,c),h.prototype.format=function(t,i,e){var n=u(e,this.width);f(t,i).h(n[0]).addTo(this),f(t+n[0]+this.width,i+this.height).h(n[1]).addTo(this),t+=n[0];for(var r=0;r<this.items.length;r++){var h=this.items[r];h.needsSpace&&(f(t,i).h(10).addTo(this),t+=10),h.format(t,i,h.width).addTo(this),t+=h.width,i+=h.height,h.needsSpace&&(f(t,i).h(10).addTo(this),t+=10)}return this},i(s,c),s.prototype.format=function(t,i,e){for(var n=t,r=0;r<this.items.length;r++){var h=this.items[r];h.needsSpace&&(f(t,i).h(10).addTo(this),t+=10),h.format(t,i,Math.max(h.width+h.offsetX,2*m.ARC_RADIUS)).addTo(this),t+=Math.max(h.width+h.offsetX,2*m.ARC_RADIUS),i+=h.height,h.needsSpace&&(f(t,i).h(10).addTo(this),t+=10),r!==this.items.length-1&&(f(t,i).arc("ne").down(Math.max(h.down,m.VERTICAL_SEPARATION)).arc("es").left(t-n-2*m.ARC_RADIUS).arc("nw").down(Math.max(this.items[r+1].up,m.VERTICAL_SEPARATION)).arc("ws").addTo(this),i+=Math.max(h.down,m.VERTICAL_SEPARATION)+Math.max(this.items[r+1].up,m.VERTICAL_SEPARATION)+4*m.ARC_RADIUS,t=n+2*m.ARC_RADIUS)}return f(t,i).h(e-(this.width+this.offsetX)).addTo(this),this},i(a,c),a.prototype.format=function(t,i,e){var n=u(e,this.width);f(t,i).h(n[0]).addTo(this),f(t+n[0]+this.width,i+this.height).h(n[1]).addTo(this),t+=n[0];for(var r=this.items.length-1,h=this.width-4*m.ARC_RADIUS,s=this.normal-1;0<=s;s--){var a=this.items[s];if(s==this.normal-1)var o=Math.max(2*m.ARC_RADIUS,this.items[s+1].up+m.VERTICAL_SEPARATION+a.height+a.down);f(t,i).arc("se").up(o-2*m.ARC_RADIUS).arc("wn").addTo(this),a.format(t+2*m.ARC_RADIUS,i-o,h).addTo(this),f(t+2*m.ARC_RADIUS+h,i-o+a.height).arc("ne").down(o-a.height+this.items[this.normal].height-2*m.ARC_RADIUS).arc("ws").addTo(this),o+=Math.max(m.ARC_RADIUS,a.up+m.VERTICAL_SEPARATION+(0==s?0:this.items[s-1].down+this.items[s-1].height))}f(t,i).right(2*m.ARC_RADIUS).addTo(this),this.items[this.normal].format(t+2*m.ARC_RADIUS,i,h).addTo(this),f(t+2*m.ARC_RADIUS+h,i+this.height).right(2*m.ARC_RADIUS).addTo(this);for(s=this.normal+1;s<=r;s++){a=this.items[s];if(s==this.normal+1)o=Math.max(2*m.ARC_RADIUS,this.items[s-1].height+this.items[s-1].down+m.VERTICAL_SEPARATION+a.up);f(t,i).arc("ne").down(o-2*m.ARC_RADIUS).arc("ws").addTo(this),a.format(t+2*m.ARC_RADIUS,i+o,h).addTo(this),f(t+2*m.ARC_RADIUS+h,i+o+a.height).arc("se").up(o-2*m.ARC_RADIUS+a.height-this.items[this.normal].height).arc("wn").addTo(this),o+=Math.max(m.ARC_RADIUS,a.height+a.down+m.VERTICAL_SEPARATION+(s==r?0:this.items[s+1].up))}return this},i(p,c),p.prototype.needsSpace=!0,p.prototype.format=function(t,i,e){var n=u(e,this.width);f(t,i).h(n[0]).addTo(this),f(t+n[0]+this.width,i+this.height).h(n[1]).addTo(this),f(t+=n[0],i).right(m.ARC_RADIUS).addTo(this),this.item.format(t+m.ARC_RADIUS,i,this.width-2*m.ARC_RADIUS).addTo(this),f(t+this.width-m.ARC_RADIUS,i+this.height).right(m.ARC_RADIUS).addTo(this);var r=Math.max(2*m.ARC_RADIUS,this.item.height+this.item.down+m.VERTICAL_SEPARATION+this.rep.up);return f(t+m.ARC_RADIUS,i).arc("nw").down(r-2*m.ARC_RADIUS).arc("ws").addTo(this),this.rep.format(t+m.ARC_RADIUS,i+r,this.width-2*m.ARC_RADIUS).addTo(this),f(t+this.width-m.ARC_RADIUS,i+r+this.rep.height).arc("se").up(r-2*m.ARC_RADIUS+this.rep.height-this.item.height).arc("en").addTo(this),this},i(l,c),l.prototype.format=function(t,i){return!1===this.simpleType?this.attrs.d="M "+t+" "+(i-10)+" v 20 m 0 -10 h 20.5":this.attrs.d="M "+t+" "+(i-10)+" v 20 m 10 -20 v 20 m -10 -10 h 20.5",this},i(g,c),g.prototype.format=function(t,i){return!1===this.simpleType?this.attrs.d="M "+t+" "+i+" h 20 m 0 -10 v 20":this.attrs.d="M "+t+" "+i+" h 20 m -10 -10 v 20 m 10 -20 v 20",this},i(w,c),w.prototype.needsSpace=!0,w.prototype.format=function(t,i,e){var n=u(e,this.width);f(t,i).h(n[0]).addTo(this),f(t+n[0]+this.width,i).h(n[1]).addTo(this),c("rect",{x:t+=n[0],y:i-11,width:this.width,height:this.up+this.down,rx:10,ry:10}).addTo(this);var r=c("text",{x:t+this.width/2,y:i+4,occurrenceIdx:this.occurrenceIdx,topRuleName:this.topRuleName,dslRuleName:this.dslRuleName,tokenName:this.tokenName,label:this.label},this.text),h=c("title",{},this.title);return this.href?c("a",{"xlink:href":this.href},[r]).addTo(this):(r.addTo(this),void 0!==this.title&&h.addTo(this)),this},i(A,c),A.prototype.needsSpace=!0,A.prototype.format=function(t,i,e){var n=u(e,this.width);f(t,i).h(n[0]).addTo(this),f(t+n[0]+this.width,i).h(n[1]).addTo(this),c("rect",{x:t+=n[0],y:i-11,width:this.width,height:this.up+this.down}).addTo(this);var r=c("text",{x:t+this.width/2,y:i+4,occurrenceIdx:this.occurrenceIdx,topRuleName:this.topRuleName,ruleName:this.ruleName},this.text);return this.href?c("a",{"xlink:href":this.href},[r]).addTo(this):r.addTo(this),this},i(R,c),R.prototype.needsSpace=!0,R.prototype.format=function(t,i,e){var n=u(e,this.width);return f(t,i).h(n[0]).addTo(this),f(t+n[0]+this.width,i+this.height).h(n[1]).addTo(this),c("text",{x:(t+=n[0])+this.width/2,y:i+5,class:"comment"},this.text).addTo(this),this},i(S,c),S.prototype.format=function(t,i,e){return f(t,i).right(e).addTo(this),this},"function"==typeof define&&define.amd?(T={},define([],function(){return T})):T="object"==typeof exports?exports:(this.railroad={},this.railroad);var y=[m,function(){var t=new m([].slice.call(arguments)),i=t.items;return i.shift(),i.pop(),i.unshift(new l(!1)),i.push(new g(!1)),t.items=i,t},h,s,a,o,p,function(t,i,e){return o(p(t,i),e)},w,A,R,S];["Diagram","ComplexDiagram","Sequence","Stack","Choice","Optional","OneOrMore","ZeroOrMore","Terminal","NonTerminal","Comment","Skip"].forEach(function(t,i){T[t]=y[i]})}).call(this,{VERTICAL_SEPARATION:8,ARC_RADIUS:10,DIAGRAM_CLASS:"railroad-diagram",STROKE_ODD_PIXEL_LENGTH:!0,INTERNAL_ALIGNMENT:"center"}),function(t,i){"function"==typeof define&&define.amd?define(["../vendor/railroad-diagrams"],i):"object"==typeof module&&module.exports?module.exports=i(require("../vendor/railroad-diagrams")):t.diagrams_builder=i(t.railroad)}(this,function(r){var n=r.Diagram,h=r.Sequence,s=r.Choice,a=r.Optional,o=r.OneOrMore,d=r.ZeroOrMore,u=(r.Terminal,r.NonTerminal);function c(t,i,e){var n=void 0;return"string"!=typeof t.pattern&&"[object RegExp]"!==Object.prototype.toString.call(t.pattern)||(n=t.pattern),r.Terminal(t.label,void 0,n,t.occurrenceInParent,i,e,t.name)}function f(t,i){if("NonTerminal"===t.type)return u(function(t){return void 0!==t.nonTerminalName?t.nonTerminalName:t.name}(t),void 0,t.occurrenceInParent,i);if("Terminal"===t.type){if("Terminal"===t.type)return c(t,i,"consume");throw Error("non exhaustive match")}var e=function(t,i){return t.map(function(t){return f(t,i)})}(t.definition,i);if("Rule"===t.type)return n.apply(this,e);if("Flat"===t.type)return h.apply(this,e);if("Option"===t.type){if(1<e.length)return a(h.apply(this,e));if(1===e.length)return a(e[0]);throw Error("Empty Optional production, OOPS!")}if("Repetition"===t.type){if(1<e.length)return d(h.apply(this,e));if(1===e.length)return d(e[0]);throw Error("Empty Optional production, OOPS!")}if("Alternation"===t.type)return s.apply(this,[0].concat(e));if("RepetitionMandatory"===t.type){if(1<e.length)return o(h.apply(this,e));if(1===e.length)return o(e[0]);throw Error("Empty Optional production, OOPS!")}if("RepetitionWithSeparator"===t.type){if(0<e.length)return a(h.apply(this,e.concat([d(h.apply(this,[c(t.separator,i,"many_sep")].concat(e)))])));throw Error("Empty Optional production, OOPS!")}if("RepetitionMandatoryWithSeparator"===t.type){if(0<e.length)return h.apply(this,e.concat([d(h.apply(this,[c(t.separator,i,"at_least_one_sep")].concat(e)))]));throw Error("Empty Optional production, OOPS!")}}return{buildSyntaxDiagramsText:function(t){var e="";return t.forEach(function(t){var i=f(t,t.name);e+='<h2 class="diagramHeader">'+t.name+"</h2>"+i}),e},convertProductionToDiagram:f}}),function(t,i){"function"==typeof define&&define.amd?define([],i):"object"==typeof module&&module.exports?module.exports=i():t.diagrams_behavior=i()}(this,function(){function e(t){d(s(t.target.getAttribute("label"),"terminal","label"),"diagramRectUsage")}function n(t){var i=function(t){var i=t.getAttribute("rulename"),e=s(i,"non-terminal","rulename"),n=a(i);return{rects:e,header:n,ruleName:i}}(t.target);d(i.rects,"diagramRectUsage"),o(i.header,"diagramHeaderDef")}function r(t){!function(n,t,r){var h=window.scrollY,s=(n=n||0,t=t||2e3,r=r||"easeOutSine",0),a=Math.max(.1,Math.min(Math.abs(h-n)/t,.8)),o=(Math.PI,{easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)}});!function t(){var i=(s+=1/60)/a,e=o[r](i);i<1?(c(t),window.scrollTo(0,h+(n-h)*e)):window.scrollTo(0,n)}()}(a(t.target.getAttribute("rulename")).offsetTop,666,"easeInOutQuint")}function h(t){o(t.target,"diagramHeaderDef"),d(s(t.target.innerHTML,"non-terminal","rulename"),"diagramRectUsage")}function s(i,t,e){return f(u(document.getElementsByClassName(t)),"rect").filter(function(t){return t.parentNode.getElementsByTagName("text")[0].getAttribute(e)===i})}function a(i){return u(document.getElementsByClassName("diagramHeader")).find(function(t){return t.innerHTML===i})}function o(t,i){t.classList.contains(i)?t.classList.remove(i):t.classList.add(i)}function d(t,i){t.forEach(function(t){o(t,i)})}function u(t){return Array.prototype.slice.call(t)}var c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};function f(t,i){var e=[];return t.forEach(function(t){u(t.children).forEach(function(t){t.tagName===i&&e.push(t)})}),e}return{initDiagramsBehavior:function(i){void 0===i&&(i=!0),u(document.getElementsByClassName("diagramHeader")).forEach(function(t){t.addEventListener("mouseover",h),t.addEventListener("mouseout",h)}),f(u(document.getElementsByClassName("non-terminal")),"text").forEach(function(t){t.addEventListener("mouseover",n),t.addEventListener("mouseout",n),i&&t.addEventListener("click",r)}),f(u(document.getElementsByClassName("terminal")),"text").forEach(function(t){t.addEventListener("mouseover",e),t.addEventListener("mouseout",e)})}}}),function(t,i){"function"==typeof define&&define.amd?define(["./diagrams_builder","./diagrams_behavior"],i):"object"==typeof module&&module.exports?module.exports=i(require("./diagrams_builder"),require("./diagrams_behavior")):t.main=i(t.diagrams_builder,t.diagrams_behavior)}(this,function(n,r){return{drawDiagramsFromParserInstance:function(t,i){var e=t.getSerializedGastProductions();i.innerHTML=n.buildSyntaxDiagramsText(e),r.initDiagramsBehavior()},drawDiagramsFromSerializedGrammar:function(t,i){i.innerHTML=n.buildSyntaxDiagramsText(t),r.initDiagramsBehavior()}}});